{% extends "base.html" %}

{% block title %}Dashboard - Whale Wallet{% endblock %}

{% block content %}
<div class="page-header">
    <div>
        <div class="page-eyebrow">SOVEREIGN · WEALTH · PRESERVATION</div>
        <h1 class="page-title">Dashboard</h1>
        <p class="page-subtitle">Real-time portfolio overview and system status</p>
    </div>
    <div class="page-actions">
        <button class="btn" onclick="WhaleWallet.Toast.info('Refreshing data...')">Refresh</button>
        <button class="btn btn-primary" onclick="Modal.open('new-tx-modal')">New Transaction</button>
    </div>
</div>

<!-- KPI Grid -->
<div class="kpi-grid">
    <div class="kpi-card">
        <div class="kpi-value">$1.23M</div>
        <div class="kpi-label">Total Value</div>
        <div class="kpi-sub">+12.4% (24h)</div>
    </div>
    <div class="kpi-card">
        <div class="kpi-value">18</div>
        <div class="kpi-label">Active Chains</div>
        <div class="kpi-sub">All synced</div>
    </div>
    <div class="kpi-card">
        <div class="kpi-value">4</div>
        <div class="kpi-label">Active Policies</div>
        <div class="kpi-sub">12 blocked (30d)</div>
    </div>
    <div class="kpi-card">
        <div class="kpi-value">99.9%</div>
        <div class="kpi-label">Uptime</div>
        <div class="kpi-sub">MPC healthy</div>
    </div>
</div>

<!-- MPC Status -->
<div class="card mb-xl">
    <div class="card-header">
        <span class="card-label">MPC Status</span>
        <span class="badge badge-success">Healthy</span>
    </div>
    <div class="mpc-grid">
        <div class="mpc-node active">
            <div class="mpc-icon">M</div>
            <span class="mpc-label">Mobile</span>
        </div>
        <div class="mpc-node active">
            <div class="mpc-icon">S</div>
            <span class="mpc-label">Server</span>
        </div>
        <div class="mpc-node active">
            <div class="mpc-icon">R</div>
            <span class="mpc-label">Recovery</span>
        </div>
    </div>
    <div class="flex justify-center mt-lg gap-lg" style="font-size: 12px; color: var(--text-muted);">
        <span>Last rotation: 30 days ago</span>
        <span>·</span>
        <span>Next recommended: 60 days</span>
    </div>
</div>

<!-- Two Column Layout -->
<div class="grid grid-2">
    <!-- Recent Transactions -->
    <div class="card">
        <div class="card-header">
            <span class="card-label">Recent Transactions</span>
            <a href="/transactions" class="btn btn-sm">View All</a>
        </div>
        <table class="data-table">
            <thead>
                <tr>
                    <th>Type</th>
                    <th>Amount</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Send</td>
                    <td class="mono">-1.5 ETH</td>
                    <td class="status-active">Confirmed</td>
                </tr>
                <tr>
                    <td>Receive</td>
                    <td class="mono">+50 SOL</td>
                    <td class="status-active">Confirmed</td>
                </tr>
                <tr>
                    <td>Swap</td>
                    <td class="mono">5K USDC → ETH</td>
                    <td class="status-pending">Pending</td>
                </tr>
                <tr>
                    <td>Send</td>
                    <td class="mono">-0.1 BTC</td>
                    <td class="status-active">Confirmed</td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Active Policies -->
    <div class="card">
        <div class="card-header">
            <span class="card-label">Active Policies</span>
            <a href="/policies" class="btn btn-sm">Manage</a>
        </div>
        <div class="flex flex-col gap-md">
            <div class="policy-card active">
                <div class="policy-info">
                    <div class="policy-icon">VL</div>
                    <div>
                        <div class="policy-name">Daily Velocity Limit</div>
                        <div class="policy-desc">Max $10,000/24h</div>
                    </div>
                </div>
                <span class="badge badge-success">Active</span>
            </div>
            <div class="policy-card active">
                <div class="policy-info">
                    <div class="policy-icon">WL</div>
                    <div>
                        <div class="policy-name">Whitelist Only</div>
                        <div class="policy-desc">5 addresses</div>
                    </div>
                </div>
                <span class="badge badge-success">Active</span>
            </div>
            <div class="policy-card active">
                <div class="policy-info">
                    <div class="policy-icon">TL</div>
                    <div>
                        <div class="policy-name">Time Lock</div>
                        <div class="policy-desc">24h delay &gt;$50K</div>
                    </div>
                </div>
                <span class="badge badge-success">Active</span>
            </div>
        </div>
    </div>
</div>

<!-- Pipeline Visualization -->
<div class="mt-xl">
    <div class="card-label mb-md">Transaction Flow</div>
    <div class="pipeline">
        <div class="pipeline-node">Initiate</div>
        <div class="pipeline-arrow">→</div>
        <div class="pipeline-node">Policy Check</div>
        <div class="pipeline-arrow">→</div>
        <div class="pipeline-node">MPC Sign</div>
        <div class="pipeline-arrow">→</div>
        <div class="pipeline-node">Broadcast</div>
        <div class="pipeline-arrow">→</div>
        <div class="pipeline-node">Confirm</div>
    </div>
</div>

<!-- New Transaction Modal -->
<div class="modal-overlay" id="new-tx-modal">
    <div class="modal">
        <div class="modal-header">
            <span class="modal-title">New Transaction</span>
            <button class="modal-close" onclick="Modal.close('new-tx-modal')">×</button>
        </div>
        <form
            onsubmit="event.preventDefault(); WhaleWallet.Toast.success('Transaction submitted'); Modal.close('new-tx-modal');">
            <div class="form-group">
                <label class="form-label">Chain</label>
                <select class="form-input form-select" required>
                    <option value="">Select chain...</option>
                    <option value="ethereum">Ethereum</option>
                    <option value="bitcoin">Bitcoin</option>
                    <option value="solana">Solana</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Recipient Address</label>
                <input type="text" class="form-input mono" placeholder="0x..." required>
            </div>
            <div class="form-group">
                <label class="form-label">Amount</label>
                <input type="number" class="form-input" placeholder="0.0" step="any" required>
            </div>
            <div class="flex gap-md mt-lg">
                <button type="button" class="btn" style="flex: 1;" onclick="Modal.close('new-tx-modal')">Cancel</button>
                <button type="submit" class="btn btn-primary" style="flex: 1;">Sign & Send</button>
            </div>
        </form>
    </div>
</div>
{% endblock %}